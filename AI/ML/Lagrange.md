# Lagrange 乘子法

Lagrange 乘子法，适用于等式约束的极值问题求解

### 曲线
$$
\begin{cases} x=x(t),  \\
y = y(t), \quad a \leq t \leq b \\
z = z(t) \end{cases}
$$
也可写成向量形式：
$$
r(t)=x(t)\textbf{i}+y(t)\textbf{j}+z(t)\textbf{k}
$$
若其**切向量** $\quad r'(t) = [x'(t),y'(t),z'(t)] \not = 0$且在$(a,b)$上连续，则曲线为**光滑曲线**

对于任意一时刻点$t_0$:

- **切向量**
	 $$r'(t_0) = [x'(t_0),y'(t_0),z'(t_0)]$$
- **切线方程**
	$$\frac{x-x_0}{x'(t_0)}=\frac{y-y_0}{y'(t_0)}=\frac{z-z_0}{z'(t_0)}$$
- **法平面方程**
	$$r'(t_0) \bullet (x-x_0,y-y_0,z-z_0)=0$$

### 曲面
一般由一个方程表示:
$$F(x,y,z)=0$$
过某一点$P_0$, 可能有无数条光滑曲线， 若写成上面参数形式则有:
$$F(x(t),y(t),z(t))=0$$
两边对$t$求导,根据链式法则得:
$$
F_xx'(t_0)+F_yy'(t_0)+F_zz'(t_0)=0
$$
上式中，梯度向量$(F_x, F_y, F_z)$对某一点$P_0$是固定的， 而过该点的光滑曲线可能有无数条，从而过该点的**切向量**有无数条。 又因为它们与梯度向量都正交，从几何上可知，它们必定全部都在与梯度方向垂直的面上,因此这个面就叫**切平面**

所以对**曲面**而言一般考察:
- **法线(梯度)**
	$$\frac{x-x_0}{F_x(P_0)}=\frac{y-y_0}{F_y(P_0)}=\frac{z-z_0}{F_z(P_0)}$$
- **切平面**
	$$(x-x_0, y-y_0, z-z_0)\bullet(F_x, F_y, F_z)=0$$

如果一个曲面有连续变动的切平面，则该曲面是**光滑曲面**

### 梯度

由上分析可知，对于一个面而言，**梯度**应该是“穿”过该点几乎垂直于面的一条线(感观上应该有这样的认识), 上山下山的比喻中，山坡的表面就是这个面, 最快的变化方向就是垂直起降

而**线**一般指**面**中的一条线(等高)，或两个**面**的相交而成的线, 线讨论的是**切线**和垂直于它的**法平面**。 若一个条线，它在某点取到极值的必要条件是， 函数考量的自变量方向关于每个因变量的变化率为零， 若是一个面，它在某点取到极值的必要条件是，**偏导数**为零，也即**梯度**为零， 由此可知**梯度**与**切向量**始终是垂直的

#### 总结一下
- 线的**梯度**是其**法平面**中的一条线，与**切向量**正交
- 约束面的**梯度**是"垂直"于该面的一条线
- 不同约束面的不同**梯度**方向构成一个面，该**面**与该**线**的切向量正交
- 不同的约束面相交而成为一条**线**，即该线，是目标函数的可行域
- 终极目标是求可行域内该线的**极值**，在该处，线的**梯度**与不同约束面的在该处的**梯度**共面，因此它可由不同约束面的梯度线性表出
- 多维情况下，$n>3$, 面是指**"超面"**，目标函数的可行域是**"超线"**(面的交)，极值处的梯度可由超面的梯度线性表出。

这就是**Lagrange**乘子法可行的所有理论基础

### 三维例子
$$
L(x,y,z) = f(x,y,z)-\lambda G(x,y,z) - \mu H(x,y,z) \\
\begin {cases} L_x=0 \\
L_y=0\\
L_z=0\\
G(x,y,z)=0\\
H(x,y,z)=0\\
\end{cases}
$$

$L(x,y,z)$的极值点也是目标函数$f(x,y,z)$在可行约束内的极值点，如果存在的话(方程组有解)




